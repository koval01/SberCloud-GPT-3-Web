function shuffle(array) {
  var currentIndex = array.length,  randomIndex;

  // While there remain elements to shuffle...
  while (0 !== currentIndex) {

    // Pick a remaining element...
    randomIndex = Math.floor(Math.random() * currentIndex);
    currentIndex--;

    // And swap it with the current element.
    [array[currentIndex], array[randomIndex]] = [
      array[randomIndex], array[currentIndex]];
  }

  return array;
}
function format_result(start_, list_) {
  const list_formatted = JSON.parse(list_);
  let result_list = null;
  
  for (let i = 0; i < list_formatted.length; i++) {
    result_list.append("<figure><blockquote class=\"blockquote\"><b>"+start_+"</b><i>"+list_formatted[i]+"</i></blockquote><figcaption class=\"blockquote-footer\">story.q-writer.com</figcaption></figure>");
  }
  return result_list;
}
function generate_continue() {
    var urls = [
        'https://orange-shadow.koval.workers.dev/',
    ];
    const len_c = 60;
    const button = $("#generate_continue_button"),
        loader = button.find("span");
    const txt_c = $("textarea").val();
    shuffle(urls);
    
    for (let i = 0; i < urls.length; i++) {
        $.ajax({
          url: urls[i],
          type: "POST",
          contentType: "application/json",
          data: JSON.stringify({
            prompt: txt_c,
            length: len_c,
          }),
          beforeSend: function () {
          },
          success: function (o) {
            let block = $("#result_continue_block");
            block.empty(), block.append(format_result(txt_c, o));
          },
          error: function () {
            alert("Извините, но произошла ошибка...");
          },
        });
    }
}
